---

title: Deep learning 101 with Pytorch and fastai


keywords: fastai
sidebar: home_sidebar

summary: "Some code and text snippets have been extracted from the book <a href='https://muellerzr.github.io/fastblog/2021/02/14/Pytorchtofastai.html'>\"Deep Learning for Coders with Fastai and Pytorch: AI Applications Without a PhD\"](https://course.fast.ai/), and from these blog posts [[ref1</a>]."
description: "Some code and text snippets have been extracted from the book <a href='https://muellerzr.github.io/fastblog/2021/02/14/Pytorchtofastai.html'>\"Deep Learning for Coders with Fastai and Pytorch: AI Applications Without a PhD\"](https://course.fast.ai/), and from these blog posts [[ref1</a>]."
nb_path: "nbs/00_dl_101_pytorch_fastai.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/00_dl_101_pytorch_fastai.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">use_cuda</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span> <span class="k">if</span> <span class="n">use_cuda</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<span class="n">device</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>device(type=&#39;cuda&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Linear-regression-model-in-Pytorch">Linear regression model in Pytorch<a class="anchor-link" href="#Linear-regression-model-in-Pytorch"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Datasets-and-Dataloaders">Datasets and Dataloaders<a class="anchor-link" href="#Datasets-and-Dataloaders"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll create a dataset that contains $(x,y)$ pairs sampled from the linear function $y = ax + b+ \epsilon$. To do this, we'll create a PyTorch's <code>TensorDataset</code>.</p>
<p>A PyTorch tensor is nearly the same thing as a NumPy array. The vast majority of methods and operators supported by NumPy on these structures are also supported by PyTorch, but PyTorch tensors have additional capabilities. One major capability is that these structures can live on the GPU, in which case their computation will be optimized for the GPU and can run much faster (given lots of values to work on). In addition, PyTorch can automatically calculate derivatives of these operations, including combinations of operations. These two things are critical for deep learning</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="linear_function_dataset" class="doc_header"><code>linear_function_dataset</code><a href="https://github.com/stardust-r/wwdl/tree/main/wwdl/dl_101.py#L13" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>linear_function_dataset</code>(<strong><code>a</code></strong>, <strong><code>b</code></strong>, <strong><code>n</code></strong>=<em><code>100</code></em>, <strong><code>show_plot</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Creates a Pytorch's <code>TensorDataset</code> with <code>n</code> random samples of the
linear function y = <code>a</code>*x + <code>b</code>. <code>show_plot</code> dcides whether or not to
plot the dataset</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">linear_function_dataset</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">show_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">test_eq</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">TensorDataset</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In every machine/deep learning experiment, we need to have at least two datasets:</p>
<ul>
<li>training: used to train the model</li>
<li>validation: used to validate the model after each training step. It allows to detect overfitting and adjust the hyperparameters of the model properly</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_ds</span> <span class="o">=</span> <span class="n">linear_function_dataset</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">show_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">valid_ds</span> <span class="o">=</span> <span class="n">linear_function_dataset</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">show_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A dataloader combines a dataset an a sampler that samples data into <strong>batches</strong>, and provides an iterable over the given dataset.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bs</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">train_dl</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">bs</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">valid_dl</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">valid_ds</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">bs</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_dl</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">data</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;batch </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">: x=</span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">device</span><span class="si">}</span><span class="s1">), y=</span><span class="si">{</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="n">y</span><span class="o">.</span><span class="n">device</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>batch 1: x=torch.Size([10, 1]) (cpu), y=torch.Size([10, 1]) (cpu)
batch 2: x=torch.Size([10, 1]) (cpu), y=torch.Size([10, 1]) (cpu)
batch 3: x=torch.Size([10, 1]) (cpu), y=torch.Size([10, 1]) (cpu)
batch 4: x=torch.Size([10, 1]) (cpu), y=torch.Size([10, 1]) (cpu)
batch 5: x=torch.Size([10, 1]) (cpu), y=torch.Size([10, 1]) (cpu)
batch 6: x=torch.Size([10, 1]) (cpu), y=torch.Size([10, 1]) (cpu)
batch 7: x=torch.Size([10, 1]) (cpu), y=torch.Size([10, 1]) (cpu)
batch 8: x=torch.Size([10, 1]) (cpu), y=torch.Size([10, 1]) (cpu)
batch 9: x=torch.Size([10, 1]) (cpu), y=torch.Size([10, 1]) (cpu)
batch 10: x=torch.Size([10, 1]) (cpu), y=torch.Size([10, 1]) (cpu)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Defining-a-linear-regression-model-in-Pytorch">Defining a linear regression model in Pytorch<a class="anchor-link" href="#Defining-a-linear-regression-model-in-Pytorch"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The class <code>torch.nn.Module</code> is the base structure for all models in Pytorch. It mostly helps to register all the trainable parameters. A module is an object of a class that inherits from the PyTorch <code>nn.Module</code> class.</p>
<p>To implement an <code>nn.Module</code> you just need to:</p>
<ul>
<li>Make sure the superclass <strong>init</strong> is called first when you initialize it.</li>
<li>Define any parameters of the model as attributes with nn.Parameter. To tell <code>Module</code> that we want to treat a tensor as a parameter, we have to wrap it in the <code>nn.Parameter</code> class. All PyTorch modules use <code>nn.Parameter</code> for any trainable parameters. This class doesn't actually add any functionality (other than automatically calling <code>requires_grad</code>). It's only used as a "marker" to show what to include in parameters:</li>
<li>Define a forward function that returns the output of your model.</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LinRegModel" class="doc_header"><code>class</code> <code>LinRegModel</code><a href="https://github.com/stardust-r/wwdl/tree/main/wwdl/dl_101.py#L26" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LinRegModel</code>() :: <code>Module</code></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super(Model, self).__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>
<p>:ivar training: Boolean represents whether this module is in training or
                evaluation mode.
:vartype training: bool</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">LinRegModel</span><span class="p">()</span>
<span class="n">pa</span><span class="p">,</span> <span class="n">pb</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">()</span>
<span class="n">pa</span><span class="p">,</span> <span class="n">pa</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">pb</span><span class="p">,</span> <span class="n">pb</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(Parameter containing:
 tensor([-0.1623], requires_grad=True),
 torch.Size([1]),
 Parameter containing:
 tensor([-0.3689], requires_grad=True),
 torch.Size([1]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Objects of this class behave identically to standard Python functions, in that you can call them using parentheses and they will return the activations of a model.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">out</span><span class="o">.</span><span class="n">shape</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor([[ 1.6960],
         [ 0.3434],
         [-0.5049],
         [-0.3151],
         [ 2.5839],
         [ 0.8094],
         [-0.8670],
         [-0.4008],
         [-1.6220],
         [ 1.1903]]),
 torch.Size([10, 1]),
 tensor([[-0.6443],
         [-0.4247],
         [-0.2870],
         [-0.3178],
         [-0.7884],
         [-0.5003],
         [-0.2282],
         [-0.3039],
         [-0.1056],
         [-0.5622]], grad_fn=&lt;AddBackward0&gt;),
 torch.Size([10, 1]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Loss-function-and-optimizer">Loss function and optimizer<a class="anchor-link" href="#Loss-function-and-optimizer"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The loss is the thing the machine is using as the measure of performance to decide how to update model parameters. The loss function is simple enough for a regression problem, we'll just use the Mean Square Error (MSE)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">loss_func</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
<span class="n">loss_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(2.4990, grad_fn=&lt;MseLossBackward&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have data, a model, and a loss function; we only need one more thing we can fit a model, and that's an optimizer.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">opt_func</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span> <span class="o">=</span> <span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Training-loop">Training loop<a class="anchor-link" href="#Training-loop"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>During training, we need to push our model and our batches to the GPU. Calling <code>cuda()</code> on a model or a tensor this class puts all these parameters on the GPU:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To train a model, we will need to compute all the gradients of a given loss with respect to its parameters, which is known as the <em>backward pass</em>. The <em>forward pass</em> is where we compute the output of the model on a given input, based on the matrix products. PyTorch computes all the gradients we need with a magic call to <code>loss.backward</code>. The backward pass is the chain rule applied multiple times, computing the gradients from the output of our model and going back, one layer at a time.</p>
<p>In Pytorch, Each basic function we need to differentiate is written as a <code>torch.autograd.Function</code> object that has a <code>forward</code> and a <code>backward</code> method. PyTorch will then keep trace of any computation we do to be able to properly run the backward pass, unless we set the <code>requires_grad</code> attribute of our tensors to <code>False</code>.</p>
<p>For minibatch gradient descent (the usual way of training in deep learning), we calculate gradients on batches. Before moving onto the next batch, we modify our model's parameters based on the gradients. For each iteration through our dataset (which would be called an <strong>epoch</strong>), the optimizer would perform as many updates as we have batches.</p>
<p>There are two important methods in a Pytorch optimizer:</p>
<ul>
<li><code>zero_grad</code>: In PyTorch, we need to set the gradients to zero before starting to do backpropragation because PyTorch accumulates the gradients on subsequent backward passes. <code>zero_grad</code> just loops through the parameters of the model and sets the gradients to zero. It also calls <code>detach_</code>, which removes any history of gradient computation, since it won't be needed after <code>zero_grad</code>.</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="train" class="doc_header"><code>train</code><a href="https://github.com/stardust-r/wwdl/tree/main/wwdl/dl_101.py#L35" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>train</code>(<strong><code>model</code></strong>, <strong><code>device</code></strong>, <strong><code>train_dl</code></strong>, <strong><code>loss_func</code></strong>, <strong><code>opt_func</code></strong>, <strong><code>epoch_idx</code></strong>)</p>
</blockquote>
<p>Train <code>model</code> for one epoch, whose index is given in <code>epoch_idx</code>. The
training loop will iterate through all the batches of <code>train_dl</code>, using
the the loss function given in <code>loss_func</code> and the optimizer given in <code>opt_func</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_epochs</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">train_dl</span><span class="p">,</span> <span class="n">loss_func</span><span class="p">,</span> <span class="n">opt_func</span><span class="p">,</span> <span class="n">epoch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Train loss [Epoch 1]:  15.59)
Train loss [Epoch 2]:  14.98)
Train loss [Epoch 3]:  14.40)
Train loss [Epoch 4]:  13.84)
Train loss [Epoch 5]:  13.30)
Train loss [Epoch 6]:  12.78)
Train loss [Epoch 7]:  12.28)
Train loss [Epoch 8]:  11.81)
Train loss [Epoch 9]:  11.34)
Train loss [Epoch 10]:  10.90)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see how the parameters of the regression model are getting closer to the truth values <code>a</code> and <code>b</code> from the linear function.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">L</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">named_parameters</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#2) [(&#39;a&#39;, Parameter containing:
tensor([0.2301], device=&#39;cuda:0&#39;, requires_grad=True)),(&#39;b&#39;, Parameter containing:
tensor([0.2354], device=&#39;cuda:0&#39;, requires_grad=True))]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Validating-the-model">Validating the model<a class="anchor-link" href="#Validating-the-model"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Validating the model requires only a forward pass, it's just inference. Disabling gradient calculation with the method <code>torch.no_grad()</code> is useful for inference, when you are sure that you will not call :meth:<code>Tensor.backward()</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="validate" class="doc_header"><code>validate</code><a href="https://github.com/stardust-r/wwdl/tree/main/wwdl/dl_101.py#L61" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>validate</code>(<strong><code>model</code></strong>, <strong><code>device</code></strong>, <strong><code>dl</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">validate</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">valid_dl</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Valid loss:  11.92
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order to spot overfitting, it is useful to validate the model after each training epoch.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_epochs</span> <span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">train</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">train_dl</span><span class="p">,</span> <span class="n">loss_func</span><span class="p">,</span> <span class="n">opt_func</span><span class="p">,</span> <span class="n">epoch</span><span class="p">)</span>
    <span class="n">validate</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">valid_dl</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Train loss [Epoch 1]:  10.48)
Valid loss:  11.46
Train loss [Epoch 2]:  10.07)
Valid loss:  11.01
Train loss [Epoch 3]:  9.68)
Valid loss:  10.58
Train loss [Epoch 4]:  9.30)
Valid loss:  10.16
Train loss [Epoch 5]:  8.94)
Valid loss:  9.77
Train loss [Epoch 6]:  8.59)
Valid loss:  9.38
Train loss [Epoch 7]:  8.26)
Valid loss:  9.02
Train loss [Epoch 8]:  7.93)
Valid loss:  8.66
Train loss [Epoch 9]:  7.62)
Valid loss:  8.32
Train loss [Epoch 10]:  7.33)
Valid loss:  8.00
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Abstracting-the-manual-training-loop:-moving-from-Pytorch-to-fastai">Abstracting the manual training loop: moving from Pytorch to fastai<a class="anchor-link" href="#Abstracting-the-manual-training-loop:-moving-from-Pytorch-to-fastai"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.basics</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">fastai.callback.progress</span> <span class="kn">import</span> <span class="n">ProgressCallback</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can entirely replace the custom training loop with fastai's. That means you can get rid of <code>train()</code>, <code>validate()</code>, and the epoch loop in the original code, and replace it all with a couple of lines.</p>
<p>fastai's training loop lives in a <code>Learner</code>. The Learner is the glue that merges everything together (Datasets, Dataloaders, model and optimizer) and enables to train by just calling a <code>fit</code> function.</p>
<p>fastai's <code>Learner</code> expects DataLoaders to be used, rather than simply one DataLoader, so let's make that. We could just do <code>dls = Dataloaders(train_dl, valid_dl)</code>, to keep the PyTorch Dataloaders. However, by using a fastai <code>DataLoader</code> instead, created directly from the <code>TensorDataset</code> objects, we have some automations, such as automatic pushing of the data to GPU.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">DataLoaders</span><span class="o">.</span><span class="n">from_dsets</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="n">valid_ds</span><span class="p">,</span> <span class="n">bs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">LinRegModel</span><span class="p">(),</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">(),</span> <span class="n">opt_func</span><span class="o">=</span><span class="n">SGD</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we have everything needed to do a basic <code>fit</code>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>6.368925</td>
      <td>6.652071</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>1</td>
      <td>6.233027</td>
      <td>6.391272</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>2</td>
      <td>6.081585</td>
      <td>6.140684</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>3</td>
      <td>5.927457</td>
      <td>5.899893</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5.789435</td>
      <td>5.668490</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>5</td>
      <td>5.640563</td>
      <td>5.446169</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>6</td>
      <td>5.487903</td>
      <td>5.232544</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>7</td>
      <td>5.326789</td>
      <td>5.027249</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>8</td>
      <td>5.176148</td>
      <td>4.830004</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>9</td>
      <td>5.014451</td>
      <td>4.640473</td>
      <td>00:00</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Having a Learner allows us to easily gather the model predictions for the validation set, which we can use for visualisation and analysis</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inputs</span><span class="p">,</span> <span class="n">preds</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">get_preds</span><span class="p">(</span><span class="n">with_input</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">inputs</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">preds</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">outputs</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([20, 1]), torch.Size([20, 1]), torch.Size([20, 1]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_TensorFunction1D</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">y_hat</span><span class="o">=</span><span class="n">preds</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Building-a-simple-neural-network">Building a simple neural network<a class="anchor-link" href="#Building-a-simple-neural-network"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For the next example, we will create the dataset by sampling values from a non linear sample $y(x) = -\frac{1}{100}x^7 - x^4 - 2x^2 - 4x + 1$</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">ntrain</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">nvalid</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span>
    <span class="n">nh1</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span>
    <span class="n">nh2</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
    <span class="n">nh3</span> <span class="o">=</span> <span class="mi">50</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">run</span> <span class="o">=</span> <span class="n">wandb</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="s2">&quot;TS-III&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre><span class="ansi-blue-intense-fg ansi-bold">wandb</span>: Currently logged in as: <span class="ansi-yellow-fg">vrodriguezf</span> (use `wandb login --relogin` to force relogin)
<span class="ansi-blue-intense-fg ansi-bold">wandb</span>: wandb version 0.10.22 is available!  To upgrade, please run:
<span class="ansi-blue-intense-fg ansi-bold">wandb</span>:  $ pip install wandb --upgrade
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

                Tracking run with wandb version 0.10.21<br/>
                Syncing run <strong style="color:#cdcd00">cerulean-sky-3</strong> to <a href="https://wandb.ai" target="_blank">Weights & Biases</a> <a href="https://docs.wandb.com/integrations/jupyter.html" target="_blank">(Documentation)</a>.<br/>
                Project page: <a href="https://wandb.ai/vrodriguezf/TS-III" target="_blank">https://wandb.ai/vrodriguezf/TS-III</a><br/>
                Run page: <a href="https://wandb.ai/vrodriguezf/TS-III/runs/3fr7wgq3" target="_blank">https://wandb.ai/vrodriguezf/TS-III/runs/3fr7wgq3</a><br/>
                Run data is saved locally in <code>/home/victor/work/walk-with-deep-learning/nbs/wandb/run-20210310_164133-3fr7wgq3</code><br/><br/>
            
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="nonlinear_function_dataset" class="doc_header"><code>nonlinear_function_dataset</code><a href="https://github.com/stardust-r/wwdl/tree/main/wwdl/dl_101.py#L75" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>nonlinear_function_dataset</code>(<strong><code>n</code></strong>=<em><code>100</code></em>, <strong><code>show_plot</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Creates a Pytorch's <code>TensorDataset</code> with <code>n</code> random samples of the
nonlinear function y = (-1/100)<em>x<strong>7 -x</strong>4 -2</em>x*<em>2 -4</em>x + 1 with a bit
of noise. <code>show_plot</code> decides whether or not to plot the dataset</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">nonlinear_function_dataset</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">show_plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">tensors</span>
<span class="n">test_eq</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will create the trainin and test dataset, and build the Dataloaders with them, this time directly in fastai, using the <code>Dataloaders.from_dsets</code> method.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_ds</span> <span class="o">=</span> <span class="n">nonlinear_function_dataset</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">valid_ds</span> <span class="o">=</span> <span class="n">nonlinear_function_dataset</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Normalization in deep learning are used to make optimization easier by smoothing the loss surface of the network. We will normalize the data based on the mean and std of the train dataset</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">norm_mean</span> <span class="o">=</span> <span class="n">train_ds</span><span class="o">.</span><span class="n">tensors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">norm_std</span> <span class="o">=</span> <span class="n">train_ds</span><span class="o">.</span><span class="n">tensors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_ds_norm</span> <span class="o">=</span> <span class="n">TensorDataset</span><span class="p">(</span><span class="n">train_ds</span><span class="o">.</span><span class="n">tensors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                              <span class="p">(</span><span class="n">train_ds</span><span class="o">.</span><span class="n">tensors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">norm_mean</span><span class="p">)</span><span class="o">/</span><span class="n">norm_std</span><span class="p">)</span>
<span class="n">valid_ds_norm</span> <span class="o">=</span> <span class="n">TensorDataset</span><span class="p">(</span><span class="n">valid_ds</span><span class="o">.</span><span class="n">tensors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                              <span class="p">(</span><span class="n">valid_ds</span><span class="o">.</span><span class="n">tensors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">norm_mean</span><span class="p">)</span><span class="o">/</span><span class="n">norm_std</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">DataLoaders</span><span class="o">.</span><span class="n">from_dsets</span><span class="p">(</span><span class="n">train_ds_norm</span><span class="p">,</span> <span class="n">valid_ds_norm</span><span class="p">,</span> <span class="n">bs</span> <span class="o">=</span> <span class="mi">32</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will build a Multi Layer Perceptron with 3 hidden layers. These networks are also known as Feed-Forward Neural Networks. The layers aof this type of networks are known as Fully Connected Layers, because, between every subsequent pair of layers, all the neurons are connected to each other.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img alt="Neural network architecture" caption="Neural network" src="https://i.imgur.com/5ZWPtRS.png"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The easiest way of wrapping several layers in Pytorch is using the <code>nn.Sequential</code> module. It creates a module with a <code>forward</code> method that will call each of the listed layers or functions in turn, without us having to do the loop manually in the forward pass.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MLP3" class="doc_header"><code>class</code> <code>MLP3</code><a href="https://github.com/stardust-r/wwdl/tree/main/wwdl/dl_101.py#L88" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MLP3</code>(<strong><code>n_in</code></strong>=<em><code>1</code></em>, <strong><code>nh1</code></strong>=<em><code>200</code></em>, <strong><code>nh2</code></strong>=<em><code>100</code></em>, <strong><code>nh3</code></strong>=<em><code>50</code></em>, <strong><code>n_out</code></strong>=<em><code>1</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Multilayer perceptron with 3 hidden layers, with sizes <code>nh1</code>, <code>nh2</code> and
<code>nh3</code> respectively.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">dls</span><span class="o">.</span><span class="n">one_batch</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MLP3</span><span class="p">()</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">output</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([32, 1])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order to have automatic logging of training parameters with Weights &amp; Biases, we add the callback <code>WandbCallback</code> to the call to <code>fit</code>. This process would be similar in any other framework we use to train a neural network (e.g., Keras)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.callback.wandb</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">MLP3</span><span class="p">(),</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">(),</span> <span class="n">opt_func</span><span class="o">=</span><span class="n">Adam</span><span class="p">,</span> 
                <span class="n">cbs</span><span class="o">=</span><span class="p">[</span><span class="n">WandbCallback</span><span class="p">()])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>WandbCallback requires use of &#34;SaveModelCallback&#34; to log best model
WandbCallback was not able to prepare a DataLoader for logging prediction samples -&gt; &#39;TensorDataset&#39; object has no attribute &#39;items&#39;
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.430214</td>
      <td>0.358961</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.389660</td>
      <td>0.382922</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.340610</td>
      <td>0.254645</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.283868</td>
      <td>0.225372</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.240199</td>
      <td>0.194012</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.205221</td>
      <td>0.199028</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.172748</td>
      <td>0.100761</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.155810</td>
      <td>0.199445</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.137792</td>
      <td>0.080331</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.104510</td>
      <td>0.063056</td>
      <td>00:00</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inputs</span><span class="p">,</span> <span class="n">preds</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">get_preds</span><span class="p">(</span><span class="n">with_input</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">show_TensorFunction1D</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">y_hat</span><span class="o">=</span><span class="n">preds</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Once we have finised training our model of interest, we can close the experiment tracker (Weights &amp; Biases)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">run</span><span class="o">.</span><span class="n">finish</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<br/>Waiting for W&B process to finish, PID 3043<br/>Program ended successfully.
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
Find user logs for this run at: <code>/home/victor/work/walk-with-deep-learning/nbs/wandb/run-20210310_164133-3fr7wgq3/logs/debug.log</code>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
Find internal logs for this run at: <code>/home/victor/work/walk-with-deep-learning/nbs/wandb/run-20210310_164133-3fr7wgq3/logs/debug-internal.log</code>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<h3>Run summary:</h3><br/><style>
    table.wandb td:nth-child(1) { padding: 0 10px; text-align: right }
    </style><table class="wandb">
<tr><td>epoch</td><td>10</td></tr><tr><td>train_loss</td><td>0.10451</td></tr><tr><td>raw_loss</td><td>0.01843</td></tr><tr><td>wd_0</td><td>0.01</td></tr><tr><td>sqr_mom_0</td><td>0.99</td></tr><tr><td>lr_0</td><td>0.001</td></tr><tr><td>mom_0</td><td>0.9</td></tr><tr><td>eps_0</td><td>1e-05</td></tr><tr><td>_runtime</td><td>10</td></tr><tr><td>_timestamp</td><td>1615394503</td></tr><tr><td>_step</td><td>309</td></tr><tr><td>valid_loss</td><td>0.06306</td></tr></table>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<h3>Run history:</h3><br/><style>
    table.wandb td:nth-child(1) { padding: 0 10px; text-align: right }
    </style><table class="wandb">
<tr><td>epoch</td><td>▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███</td></tr><tr><td>train_loss</td><td>█▆▆▅▅▄▄▄▄▄▄▄▃▃▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁</td></tr><tr><td>raw_loss</td><td>▅▅▆█▅▄▃▇▅▅▂▅▃▃▄▃▂▅▄▂▃▂▂▄▂▁▃▂▂▂▄▃▃▁▁▃▁▂▁▁</td></tr><tr><td>wd_0</td><td>▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>sqr_mom_0</td><td>▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>lr_0</td><td>▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>mom_0</td><td>▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>eps_0</td><td>▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁</td></tr><tr><td>_runtime</td><td>▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇▇████</td></tr><tr><td>_timestamp</td><td>▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▃▄▄▄▄▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇▇████</td></tr><tr><td>_step</td><td>▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇███</td></tr><tr><td>valid_loss</td><td>▇█▅▅▄▄▂▄▁▁</td></tr></table><br/>
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
Synced 5 W&B file(s), 1 media file(s), 0 artifact file(s) and 0 other file(s)
</div>

</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

                    <br/>Synced <strong style="color:#cdcd00">cerulean-sky-3</strong>: <a href="https://wandb.ai/vrodriguezf/TS-III/runs/3fr7wgq3" target="_blank">https://wandb.ai/vrodriguezf/TS-III/runs/3fr7wgq3</a><br/>
                
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's compare these results with the ones by our previous linear regression model</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn_lin</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">LinRegModel</span><span class="p">(),</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">(),</span> <span class="n">opt_func</span><span class="o">=</span><span class="n">Adam</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn_lin</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.812581</td>
      <td>0.725550</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.691438</td>
      <td>0.584854</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.599790</td>
      <td>0.499159</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.529202</td>
      <td>0.455940</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.483361</td>
      <td>0.433711</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.458033</td>
      <td>0.425526</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.443160</td>
      <td>0.421114</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.437787</td>
      <td>0.419616</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.432641</td>
      <td>0.418788</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.424229</td>
      <td>0.417838</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.416352</td>
      <td>0.418070</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.419004</td>
      <td>0.417829</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.419980</td>
      <td>0.417453</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.421106</td>
      <td>0.417162</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.420523</td>
      <td>0.417515</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.417929</td>
      <td>0.417003</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.416771</td>
      <td>0.417299</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.418802</td>
      <td>0.417479</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0.418064</td>
      <td>0.417004</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0.420583</td>
      <td>0.417536</td>
      <td>00:00</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inputs</span><span class="p">,</span> <span class="n">preds</span><span class="p">,</span> <span class="n">outputs</span> <span class="o">=</span> <span class="n">learn_lin</span><span class="o">.</span><span class="n">get_preds</span><span class="p">(</span><span class="n">with_input</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">show_TensorFunction1D</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="p">,</span> <span class="n">y_hat</span><span class="o">=</span><span class="n">preds</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

